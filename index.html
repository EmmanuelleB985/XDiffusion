<!DOCTYPE html>
<html>

<head>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XB3PR2Y1TQ"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'G-XB3PR2Y1TQ');
    </script>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>X-Diffusion: Generating Detailed 3D MRI
        Volumes From a Single Image Using
        Cross-Sectional Diffusion Models</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.min.css">
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,500,600' rel='stylesheet'
        type='text/css'>
    <link rel="stylesheet" href="assets/css/Highlight-Clean.css">
    <link rel="stylesheet" href="assets/css/styles.css">
    <!-- compare two images -->
    <!-- <link rel="stylesheet" href="assets/css/bulma.min.css"> -->
    <link rel="stylesheet" href="assets/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="assets/css/bulma-slider.min.css">

    <link rel="apple-touch-icon" sizes="180x180" href="assets/logo.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/logo.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/logo.png">


    <link rel="manifest" href="site.webmanifest">

    <meta property="og:site_name" content="X-Diffusion: Generating Detailed 3D MRI
    Volumes From a Single Image Using
    Cross-Sectional Diffusion Models" />
    <meta property="og:type" content="video.other" />
    <meta property="og:title" content="X-Diffusion: Generating Detailed 3D MRI
    Volumes From a Single Image Using
    Cross-Sectional Diffusion Models" />
    <meta property="og:description" content="X-Diffusion: Generating Detailed 3D MRI
    Volumes From a Single Image Using
    Cross-Sectional Diffusion Models" />

    <script src="assets/js/video_comparison.js"></script>
    <script type="module" src="https://unpkg.com/@google/model-viewer@2.0.1/dist/model-viewer.min.js"></script>

    <script src="assets/js/bulma-carousel.min.js"></script>
    <script src="assets/js/bulma-slider.min.js"></script>
</head>

<body>

    <div class="highlight-clean" style="padding-bottom: 10px;">
        <div class="container" style="max-width: 100%;">
            <br>
            <h1 class="text-center">X-Diffusion: Generating Detailed 3D MRI
                Volumes From a Single Image Using
                Cross-Sectional Diffusion Models</h1>
            <br>
            <br>
            <br>
            <br>
        </div>
        <div class="container align-items-center">
            <div class="container author-container">
                <div class="row authors">
                    <div class="col">
                        <h5><a href="https://emmanuellebourigault.com/">Emmanuelle Bourigault<span>&#42;</span> </a></h5>
                    </div>
                   <div class="col">
                        <h5><a href="https://abdullahamdi.com/">Abdullah Hamdi<span>&#42;</span> </a></h5>
                    </div>
                    <div class="col">
                        <h5><a href="">Amir Jamaludin </a></h5>
                    </div>
                </div>
                </div>
                <div class="row affiliations">
                    <div class="col">
                        <h6 class="text-center"><a class="text-center">Visual Geometry Group, University of Oxford</a></h6>
                    </div>
                </div>
                <h6 class="text-center"><span>&#42;</span> Equal Contribution</h6>
            </div>
        </div>
        <div class="container align-items-center">
            <div class="row text-center mx-auto">
                <div class="col-sm-4">
                    <a href="https://arxiv.org/abs/2404.19604" target="_blank" class="link-block w-inline-block">
                        <img src="assets/media/arxiv_paper.png" alt="paper" class="img-fluid" style="height:100px" /></a>
                    <br>
                    <div class="text-block-2"><strong class="bold-text-nerf_v2">Arxiv</strong></div>
                </div>
                <div class="col-sm-4">
                    <a href="https://github.com/EmmanuelleB985/X-Diffusion" target="_blank" class="link-block w-inline-block">
                        <img src="assets/media/github.png" alt="github" class="img-fluid" style="height:100px" /></a>
                    <br>
                    <div class="text-block-2"><strong class="bold-text-nerf_v2">Code</strong></div>
                </div>
                <div class="col-sm-4">
                    <a href="" target="_blank" class="link-block w-inline-block">
                        <img src="assets/media/video_logo.png" alt="Youtube" class="img-fluid" style="height:100px" /></a>
                    <br>
                    <div class="text-block-2"><strong class="bold-text-nerf_v2">Video</strong></div>
                </div>
            </div>
        </div>
        <hr class="divider" />
        <div class="row justify-content-center">
            <div class="col-sm-6">
                <img src="assets/Brain_generation.gif" style="max-width: 100%; object-fit: contain"/>
            </div>
        </div>   
        <div class="container" style="max-width: col-sm-12;">
            <div class="row">
                <div class="col-sm-12">
                    <h2>Abstract</h2>
                    <p style="text-align: justify">
                        We present X-Diffusion, a cross-sectional diffusion model tailored for Magnetic Resonance Imaging (MRI) data. X-
                        Diffusion is capable of generating the entire MRI volume from just a single MRI slice or optionally from few multiple slices, setting new benchmarks in the precision of synthesized MRIs from extremely sparse observations. The uniqueness lies in the novel view-conditional training and
                        inference of X-Diffusion on MRI volumes, allowing for generalized MRIlearning. The generated MRIs retain essential features of the original MRI, including tumour profiles,
                        spine curvature, brain volume, and beyond.
                    </p>
                </div>
            </div>
        </div>

        <hr class="divider" />
        <div class="container" style="max-width: col-sm-12;">
            <h2>Video</h2>
            <div class="row justify-content-center">
                <iframe width="600" height="378" src="assets/video/XDiffusion_Video.mp4" title="X-Diffusion" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen ></iframe>
            </div>
        </div>

        <hr class="divider" />
        <div class="container" style="max-width: col-sm-12;">
            <h2>Pipeline</h2>
            <div class="row justify-content-center">
                <iframe width="2000" height="578" src="assets/XDiffusion_Pipeline.gif" title="X-Diffusion" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen ></iframe>
            </div>
        </div>

        <hr class="divider" />
        <div class="container">
            <h2> Cross-Sectional MRI Synthesis</h2>
            <p>From an MRI slice <span class="math inline"><em>x</em>‚ÄÑ‚àà‚ÄÑ‚Ñù<sup><em>H</em>‚ÄÖ√ó‚ÄÖ<em>W</em></sup></span> , we seek to synthesize the entire MRI volume <span
                class="math inline">ùí≥‚ÄÑ‚àà‚ÄÑ‚Ñù<sup><em>H</em>‚ÄÖ√ó‚ÄÖ<em>W</em>‚ÄÖ√ó‚ÄÖ<em>D</em></sup></span>. The fundamental idea stems from the analogy that a 3D volume can be built crosswise by stacking slices from a certain direction, just like a loaf of bread. The full target volume can be reconstructed from limited slices by generating target slices indexed by their depth <span
                class="math inline"><em>d</em>‚ÄÑ‚àà‚ÄÑ[1,‚ÄÜ2,‚ÄÜ...,‚ÄÜ<em>D</em>]</span> in the MRI volume conditioned on a certain direction <span class="math inline"><em>R</em></span> where the volume is oriented. This simplifies the learning of cross-sections since the rotated MRI volume <span class="math inline"><em>R</em>ùí≥</span> will have the same size <span
                class="math inline"><em>H</em>‚ÄÖ√ó‚ÄÖ<em>W</em>‚ÄÖ√ó‚ÄÖ<em>D</em></span>  as the original volume where zero padding is used. For simplicity of the processing of the data, we use the same dimensions for all directions (<span
                class="math inline"><em>H</em>‚ÄÑ=‚ÄÑ<em>W</em>‚ÄÑ=‚ÄÑ<em>D</em></span>).
            </p>
            <p> X-Diffusion model is trained with cross-sections from all different directions <span class="math inline"><em>R</em></span> and all different depths <span class="math inline"><em>d</em></span>, which allows it to generate the target from any arbitrary rotation and depth.
                At inference , X-Diffusion is applied <span class="math inline"><em>D</em></span> times with <span
                class="math inline"><em>d</em>‚ÄÑ‚àà‚ÄÑ[1,‚ÄÜ2,‚ÄÜ..,‚ÄÜ<em>D</em>]</span> from an arbitrary orientation <span class="math inline"><em>R</em><sub><em>i</em></sub></span> to obtain the <em>view-conditional volume</em> <span
                class="math inline">ùí≥<sub><em>R</em><sub><em>i</em></sub></sub></span>.</p>
            <div class="row justify-content-center">
                <div class="col-sm-6">
                    <img src="assets/View_Conditioning.png" style="max-width: 100%; object-fit: contain"/>
                </div>
            </div>
            <h2> Multi-View MRI Volume Generation</h2>
            <p>One advantage of our cross-sectional diffusion is that it can learn and generate the volume <span class="math inline">ùí≥<sub><em>R</em><sub><em>i</em></sub></sub></span> from any arbitrary view direction <span class="math inline"><em>R</em><sub><em>i</em></sub></span>.
                In training, this allows X-Diffusion to train on MRIs from all types of cross-sections, unlike the typically followed common 3 planes (coronal, sagittal, andaxial) </p>
            <div class="row justify-content-center">
                <div class="col-sm-6">
                    <img src="assets/Volume_Averaging.gif" style="max-width: 100%; object-fit: contain"/>
                </div>
            </div>        
            
        <hr class="divider" />
        <div class="container">
            <h2> Main Results</h2>
            <p style="text-align: justify">We demonstrate high performance of X-Diffusion on BRATS dataset (see Table 1 and Figure 1) compared to baselines. From a single slice from any axis, it generates the full 3D volume. Furthermore, we show that X-Diffusion preserves key features of the MRI notably tumour profiles (see Figure 2). X-Diffusion shows good reconstruction capability on out-of-domain dataset such as knee MRIs (see Applications below). </p>
            <div class="row">
                <div class="col-sm-12">
                    <img src="assets/Table1.png" style="max-width: 90%;"/>
                    <p><span style="font-weight:bold">Table 1: Model Performance on Test Brain Data and Whole-Body MRIs.</span> We compare the MRI reconstruction for baselines ScoreMRI [19], TPDM [39] and our X-Diffusion model for varying input slice numbers in training and inference. We report the mean 3D test PSNR on BRATS (BR) brain dataset and the UK Biobank body dataset (UK). The results showcase huge improvement over the baselines, especially on the small number of input slices (particularly at 1). </p> 
                </div>
            </div>
            <h2> Generated Brain Volumes from Single Slice</h2>
            <div class="row">
                <div class="col-sm-12">
                    <img src="assets/Brain_Generation_XDiffusion.png" style="max-width: 90%;"/>
                    <p><span style="font-weight:bold">Figure 1. Visual Comparison of MRI Brain Reconstruction.</span> We show a generated slice from 3D brain generated from [Chung, H. at al, 2022] (top), TPDM [Lee, S.,2023] (middle), and X-Diffusion (bottom) conditioned on a varying number of input slices.</p> 
                </div>
            </div>
            <div class="row">
                <div class="col-sm-12">
                    <img src="assets/Brain_Seg_Maps.png" style="max-width: 90%;"/>
                    <p><span style="font-weight:bold">Figure 2. Visualisations of 3D Brain Generation.</span> We show examples of slices from generated 3D brain MRI volumes with varying slice index (top) and its ground-truth brain slices (bottom). We show the tumour profile segmentation map in all output and ground truth slices to highlight the differences and show the 3D tumor in the generated MRI and ground truth MRI in the most right column. Red is used for non-enhancing and necrotic tumor core, green for the peritumoral edema, and blue for the enhancing tumor core.</p> 
                </div>
            </div>
            <h2> Generated Whole Body MRIs</h2>
            <div class="row">
                <div class="col-sm-12">
                    <img src="assets/WholeBody_MRI_Generation.png" style="max-width: 100%;"/>
                    <p><span style="font-weight:bold">Figure 3. Alignment and Error Spread of MRI Generation.</span> (left) We show from left to right: input DXA, ground-truth MRI, generated MRI, and overlay of the two modalities to test the alignment. The 3D PSNR for this example is 26.38 dB. (right) We show the Mean Square Error of the generated MRI from a single MRI slice (index 78) as a function of the output depth index. It shows that the error is not equally distributed in the generated MRI.</p> 
                </div>
            </div>
            <h2> Applications</h2>
            <div class="row">
                <div class="col-sm-12">
                    <img src="assets/Knee_Fast_MRIs.gif" style="max-width: 100%;"/>
                </div>
            </div>
            <h2> References</h2>
            <div class="row">
            <p style="text-align: justify">Chung, H., Ye, J.C.: Score-based diffusion models for accelerated mri. Medical Image Analysis p. 102479 (2022)</p>
            <p style="text-align: justify">Lee, S., Chung, H., Park, M., Park, J., Ryu, W.S., Ye, J.C.: Improving 3d imag- ing with pre-trained perpendicular 2d diffusion models. In: Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV). pp. 10710‚Äì 10720 (October 2023)</p>
            </div>
        </div>

        <hr class="divider" />
        <div class="container">
                    <h2>Citation</h2>
                    <code>
                        @misc{bourigault2024xdiffusion,<br>
                        &nbsp; title  = {X-Diffusion: Generating Detailed 3D MRI Volumes From a Single Image Using Cross-Sectional Diffusion Models},<br>
                        &nbsp; author = {Emmanuelle Bourigault and Abdullah Hamdi and Amir Jamaludin},<br>
                        &nbsp; year   = {2024},<br>
                        &nbsp; eprint = {2404.19604},<br>
                        &nbsp; archivePrefix = {arXiv},<br>
                        &nbsp; primaryClass = {eess.IV},<br>
                    }</code>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <hr class="divider" />
        <footer class="footer">
            <div class="container">
                <div class="content has-text-centered">
                    <a class="icon-link" href="assets/videos/nerfies_paper.pdf">
                        <i class="fas fa-file-pdf"></i>
                    </a>
                    <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
                        <i class="fab fa-github"></i>
                    </a>
                </div>
                <div class="columns is-centered">
                    <div class="column is-8">
                        <div class="content">
                            <p>
                                This website is licensed under a <a rel="license"
                                    href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
                                    Commons Attribution-ShareAlike 4.0 International License</a>.
                            </p>
                            <p>
                                We borrow the <a href="https://dreamfusion3d.github.io/">source code</a> for our
                                website.
                                We thank the authors of DreamFusion for their great templates.
                                <!-- we just ask that you link back to this page in the footer.
                            Please remember to remove the analytics code included in the header of the website which
                            you do not want on your website. -->
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </footer>

        <script src="https://polyfill.io/v3/polyfill.js?features=IntersectionObserver"></script>
        <script src="assets/js/yall.js"></script>
        <script>
            yall({
                observeChanges: true
            });
        </script>
        <script src="assets/js/scripts.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/js/bootstrap.bundle.min.js">
        </script>
        <script src="https://uploads-ssl.webflow.com/51e0d73d83d06baa7a00000f/js/webflow.fd002feec.js"></script>
        <!-- Import the component -->

        <script>
            document.addEventListener('DOMContentLoaded', (event) => {
                var video = document.getElementById('speed025');
                video.playbackRate = 0.1; // Play at half speed
            });
        </script>
       
        <script>
            new BeforeAfter({
                id: '#example1'
            });
        </script>
</body>

</html>
